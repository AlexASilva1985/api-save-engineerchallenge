swagger: '2.0'
info:
  description: Work Engineer Challenge
  version: 1.0.0
  title: Work Engineer Challenge
  contact:
    name: Work
    email: email@email.com.br
    url: http://localhost:8080/engineer-challenge-api/browse
  x-technical-owner: equipesistemasdecisao@work.com.br
  x-api-key: ''
  x-namespace: ins-sales-api
host: api.engineer-challenge-api.endpoints.ins-sales-clusters-dev.cloud.goog
basePath: /insurance/sales/v1
tags:
- name: Proposal
  description: Work Engineer Challenge
schemes:
- https
securityDefinitions:
  api_key:
    type: apiKey
    name: key
    in: query
  oauth2_key:
    authorizationUrl: ''
    flow: implicit
    type: oauth2
    x-google-issuer: work-corporate-auth@ins-cross-security-auth-dev.iam.gserviceaccount.com
    x-google-jwks_uri: https://www.googleapis.com/robot/v1/metadata/x509/work-corporate-auth@ins-cross-security-auth-dev.iam.gserviceaccount.com
    x-google-audiences: api.work.com.br
security:
- api_key: [
    ]
  oauth2_key: [
    ]
parameters:
  companyId:
    in: header
    name: X-Company-Id
    required: true
    type: string
    description: Id of the Company that is using the API
  applicationId:
    in: header
    name: X-Application-Id
    required: true
    type: string
    description: Id of the Application that is using the API
  userId:
    in: header
    name: X-User-Id
    required: true
    type: string
    description: Id of the User that is using the API
  traceId:
    name: X-Trace-Id
    in: header
    description: Trace ID
    required: true
    type: string
  constructionId:
    name: constructionId
    description: Property construction type ID
    in: query
    required: true
    type: number
    format: int32
  regionId:
    name: regionId
    description: Property Region ID
    in: query
    required: true
    type: number
    format: int32
  occupationId:
    name: occupationId
    description: Property Occupation ID (CodOcupacao)
    in: query
    required: true
    type: string
  referenceDate:
    name: referenceDate
    description: Date format yyyy-MM-dd
    in: query
    required: false
    type: string
    format: date
  productId:
    name: productId
    description: 'Property Operating Product Code (codPrdOperac Produto Operacional)'
    in: query
    required: false
    type: number
    format: int32
  request:
    in: body
    name: request
    required: true
    description: 'Property Document Request'
    schema:
      $ref: '#/definitions/PropertyFactorAdjustment'
responses:
  200-Ok:
    description: Successful Request
    schema:
      $ref: '#/definitions/MarketAdjustmentFactorList'
  204-NoContent:
    description: No content
  400-BadRequest:
    description: Bad request
  401-Unauthorized:
    description: Unauthorized
    schema:
      $ref: '#/definitions/ApiError'
  403-Forbidden:
    description: Forbidden
    schema:
      $ref: '#/definitions/ApiError'
  404-DataNotFound:
    description: Data not found
    schema:
      $ref: '#/definitions/ApiError'
  405-DataInvalid:
    description: Data input not supplied or invalid
    schema:
      $ref: '#/definitions/ApiError'
  453-BusinessError:
    description: Business Exception
    schema:
      $ref: '#/definitions/BusinessError'
  500-Exception:
    description: Exception
    schema:
      $ref: '#/definitions/ApiError'
paths:
  /property/pricing/marketFactors:
    get:
      tags:
      - FactorsList
      summary: Property Market Factors List
      description: Property Market Factors List
      operationId: getPropertyFactorsList
      consumes:
      - application/json
      produces:
      - application/json
      parameters:
      - $ref: '#/parameters/companyId'
      - $ref: '#/parameters/applicationId'
      - $ref: '#/parameters/userId'
      - $ref: '#/parameters/traceId'
      - $ref: '#/parameters/constructionId'
      - $ref: '#/parameters/regionId'
      - $ref: '#/parameters/occupationId'
      - $ref: '#/parameters/referenceDate'
      responses:
        200:
          $ref: '#/responses/200-Ok'
        204:
          $ref: '#/responses/204-NoContent'
        400:
          $ref: '#/responses/400-BadRequest'
        401:
          $ref: '#/responses/401-Unauthorized'
        403:
          $ref: '#/responses/403-Forbidden'
        404:
          $ref: '#/responses/404-DataNotFound'
        405:
          $ref: '#/responses/405-DataInvalid'
        453:
          $ref: '#/responses/453-BusinessError'
        500:
          $ref: '#/responses/500-Exception'
  /property/pricing/marketFactorsBusiness:
    get:
      tags:
      - MarketFactorsBusinessList
      summary: Property Market Factors Business List
      description: Property Market Factors Business List
      operationId: getPropertyFactorsBusinessList
      consumes:
      - application/json
      produces:
      - application/json
      parameters:
      - $ref: '#/parameters/companyId'
      - $ref: '#/parameters/applicationId'
      - $ref: '#/parameters/userId'
      - $ref: '#/parameters/traceId'
      - $ref: '#/parameters/constructionId'
      - $ref: '#/parameters/regionId'
      - $ref: '#/parameters/occupationId'
      - $ref: '#/parameters/referenceDate'
      - $ref: '#/parameters/productId'
      responses:
        200:
          $ref: '#/responses/200-Ok'
        204:
          $ref: '#/responses/204-NoContent'
        400:
          $ref: '#/responses/400-BadRequest'
        401:
          $ref: '#/responses/401-Unauthorized'
        403:
          $ref: '#/responses/403-Forbidden'
        404:
          $ref: '#/responses/404-DataNotFound'
        405:
          $ref: '#/responses/405-DataInvalid'
        453:
          $ref: '#/responses/453-BusinessError'
        500:
          $ref: '#/responses/500-Exception'

  /property/pricing/factorAdjustmentBusiness:
    post:
      tags:
      - FactorAdjustmentList
      summary: Property Factors Adjustment List
      description: Property Factors Adjustment List
      operationId: PostPropertyFactorAdjustmentList
      consumes:
      - application/json
      produces:
      - application/json
      parameters:
      - $ref: '#/parameters/companyId'
      - $ref: '#/parameters/applicationId'
      - $ref: '#/parameters/userId'
      - $ref: '#/parameters/traceId'
      - $ref: '#/parameters/request'
      responses:
        200:
          description: Successful
          schema:
            type: array
            items:
              $ref: '#/definitions/AdjustmentFactorList'
        204:
          $ref: '#/responses/204-NoContent'
        400:
          $ref: '#/responses/400-BadRequest'
        401:
          $ref: '#/responses/401-Unauthorized'
        403:
          $ref: '#/responses/403-Forbidden'
        404:
          $ref: '#/responses/404-DataNotFound'
        405:
          $ref: '#/responses/405-DataInvalid'
        453:
          $ref: '#/responses/453-BusinessError'
        500:
          $ref: '#/responses/500-Exception'

  /property/pricing/marketFactorsCondominium:
    get:
      tags:
      - MarketFactorsCodominium
      summary: Property Market Factors Codominium List
      description: Property Market Factors Codominium List
      operationId: getPropertyFactorsCodominiumList
      consumes:
      - application/json
      produces:
      - application/json
      parameters:     
      - $ref: '#/parameters/constructionId'
      - $ref: '#/parameters/regionId'
      - $ref: '#/parameters/occupationId'
      - $ref: '#/parameters/referenceDate'
      - $ref: '#/parameters/productId'
      responses:
        200:
          $ref: '#/responses/200-Ok'
        204:
          $ref: '#/responses/204-NoContent'
        400:
          $ref: '#/responses/400-BadRequest'
        401:
          $ref: '#/responses/401-Unauthorized'
        403:
          $ref: '#/responses/403-Forbidden'
        404:
          $ref: '#/responses/404-DataNotFound'
        405:
          $ref: '#/responses/405-DataInvalid'
        453:
          $ref: '#/responses/453-BusinessError'
        500:
          $ref: '#/responses/500-Exception'

definitions:
  ApiError:
    type: object
    description: Error API responses
    properties:
      code:
        type: integer
        format: int32
        description: Error ID
      message:
        type: string
        description: Error Description
      description:
        type: string
        description: Error Details
      errors:
        type: array
        description: Membership Erros
        items:
          $ref: '#/definitions/Error'
  BusinessError:
    type: object
    title: BusinessError
    description: Error API response
    properties:
      code:
        type: integer
        format: int32
        description: Error ID
      message:
        type: string
        description: Error Details
      description:
        type: string
        description: Error Details
      errors:
        type: array
        description: Membership Errors
        items:
          $ref: '#/definitions/Error'
      businessNotifications:
        type: array
        description: Membership Errors
        items:
          $ref: '#/definitions/BusinessNotifications'
  Error:
    type: object
    description: Error Entity
    properties:
      code:
        type: string
        description: Error ID
      message:
        type: string
        description: Error Description
      nativeMessage:
        type: string
        description: Native Error description
      trackid:
        type: string
        description: (Optional) Track ID of transaction
  BusinessNotifications:
    type: object
    description: Error Entity
    properties:
      code:
        type: string
        description: Error ID
      description:
        type: string
        description: Error Description
      type:
        type: string
        description: info | warning

  MarketAdjustmentFactorList:
    title: MarketAdjustmentFactorList
    type: array
    items:
      $ref: '#/definitions/MarketAdjustmentFactor'

  MarketAdjustmentFactor:
    title: MarketAdjustmentFactor
    type: object
    description: Adjustment Factor
    properties:
      key:
        type: string
        description: Factor Key
      factor:
        type: number
        format: double
        description: Coefficient
    required:
    - factor
    - type

  PropertyFactorAdjustment:
    type: object
    description: 'Property Adjustment Factor'
    title: PropertyAdjustmentFactor
    properties:
      propertyDocument:
        $ref: '#/definitions/PropertyDocument'
      property:
        $ref: '#/definitions/Property'

  PropertyDocument:
    type: object
    description: 'Property Insurance Document'
    title: PropertyDocument
    properties:
      insuranceDocumentKey:
        $ref: '#/definitions/InsuranceDocumentKey'
      agency:
        $ref: '#/definitions/Agency'
      quoteVersion:
        $ref: '#/definitions/QuoteVersion'
      validity:
        $ref: '#/definitions/Validity'
      stipulating:
        $ref: '#/definitions/Stipulating'
      bureauData:
        $ref: '#/definitions/BureauData'
      customer:
        $ref: '#/definitions/Customer'
      broker:
        type: array
        items:
          $ref: '#/definitions/Broker'
      channelId:
        type: integer
        format: int32
        description: 'Quotation channel ID (CodCanal)'
      quoteDate:
        type: string
        format: date
        description: 'Quotation Date (DtCotacao)'
      commissionPercentage:
        type: number
        format: double
        description: 'Broker quotation commission (PercComissao)'
      operationTypeId:
        type: integer
        format: int32
        description: 'Document Operation Type ID (CodTpOperacao)'
      properties:
        type: array
        items:
          $ref: '#/definitions/Property' 
  
  Agency:
    title: Agency
    description: 'Agency'
    type: object
    properties:
      bankId:
        type: integer
        format: int32
        description: 'Agency Bank ID (CodBanco)'
      agencyId:
        type: integer
        format: int32
        description: 'Agency ID (CodAgencia)'
      bssId:
        type: integer
        format: int32
        description: 'Agency BSS ID (CodPAB)'
      registrationId:
        type: string
        description: 'Agency Registration ID (NroMatricula)'
      registrationId2:
        type: string
        description: 'Agency Second Registration ID (NroMatricula02)'
        
  QuoteVersion:
    title: QuoteVersion
    description: 'Calculation Version'
    type: object
    properties:
      versionId:
        type: string
        description: 'Version ID (CodVersao)'
      calculationDate:
        type: string
        format: date
        description: 'Version Date (DtCalculo)'
      quoteDueDate:
        type: string
        format: date-time
        description: 'Version Expiration Date (DtValidade)'
        
  Validity:
    title: Validity
    description: 'Insurance Validity'
    type: object
    properties:
      startDate:
        type: string
        format: date-time
        description: 'Initial Effective Date (DtIniVig)'
      endDate:
        type: string
        format: date-time
        description: 'Effective End Date (DtFimVig)'
        
  Stipulating:
    title: Stipulating
    description: 'Stipulating'
    type: object
    properties:
      id:
        type: integer
        format: int32
        description: 'Stipulating ID (CodEstipulante)'
      unityCode:
        type: integer
        format: int32
        description: 'Stipulating Unity Code (CodUnidade)'
      agreementCode:
        type: integer
        format: int32
        description: 'Stipulating Agreement Code (CodAcordo)'
      discountPercentage:
        type: number
        format: double
        description: 'Discount Percentage'
      remunerationPercentage:
        type: number
        format: double
        description: 'Renumeration Percentage (Percentual Pró-labore)'
        
  Customer:
    title: Customer
    description: 'Customer'
    type: object
    properties:
      name:
        type: string
        description: 'Customer Name (NomSegurado)'
      cpfCnpj:
        type: integer
        format: int64
        description: 'Customer CPF/CNPJ (NroCpfCnpjSeg)'
      personType:
        type: string
        description: 'Person Type (TipPessoaSegurado)'
        format: '(F - J)'
      birthDate:
        type: string
        format: date
        description: 'Customer Birth Date (DtNascSegurado)'
  
  BureauData:
    title: BureauData
    description: 'BureauData'
    type: object
    properties:
      bureauDataKey:
        type: string
        description: 'Bureau Key (ChaveCrivo)'
      underwritingSourceId:
        type: integer
        format: int32
        description: 'Bureau Underwriting Source ID (CodFonteSubscricao)'
      bureauDataDueDate:
        type: string
        format: date
        description: 'Bureau Expiration Date (DtFimVigCrivo)'
      serasaCustomScore:
        type: integer
        format: int32
        description: 'Bureau Score (PtoSerasa)'
  
  InsuranceDocumentKey:
    title: InsuranceDocumentKey
    description: 'Internal Insurance Identifier'
    type: object
    properties:
      id:
        type: integer
        format: int64
      companyId:
        type: integer
        format: int32
        description: 'Company Id (CodEmpresa)'
      organizationBranchId:
        type: integer
        format: int32
        description: 'Organization Branch ID (CodSucursal)'
      productId:
        type: integer
        format: int32
        description: 'Insurance Product ID (CodPrdOperac)'
      documentType:
        type: string
        description: 'Document Type (TipDocum)'
      documentSeq:
        type: integer
        format: int32
        description: 'Document Sequential (SeqDocum)'
      endorsementSeq:
        type: integer
        format: int32
        description: 'Endorsement Sequential issued (SeqEndosso)'
      endorsementId:
        type: integer
        format: int32
        description: 'Endorsement Sequential calculated (endorsementId)'
      quotationId:
        type: integer
        format: int64
        description: 'Quotation ID (NroCotacao)'
      quotationIdRecalc:
        type: integer
        format: int64
        description: 'Quotation ID Recalculo (NroCotacaoRecalculo)'
      originId:
        type: integer
        format: int32
        description: 'Quotation Origin ID (CodOrigem)'
      quoteGroupId:
        type: string
        description: 'Quotation Group ID (CodGrpMulticalculo)'

  Broker:
    title: Broker
    description: 'Broker'
    type: object
    properties:
      brokerId:
        type: integer
        format: int32
        description: 'Broker ID (CodCorretor)'
      typeCode:
        type: string
        format: 'Internal Broker Type (C - F)'  
        description: 'TipCorretor'
      personType:
        type: string
        description: 'Broker Person Type (TipoPessoa)'
        format: '(F-J)'
      isMain:
        type: boolean
        description: 'Broker is main of quotation? (FlagCorretorPrincipal)'
      percentageCommission:
        type: number
        format: double
        description: 'Commission Percentage (PercComissao)'
      cpf:
        type: integer
        format: int64
        description: 'Broker CPF (NroCpfCalculista)'

  Property:
    title: Property
    description: 'Property'
    type: object
    properties:
      propertySeq:
        type: integer
        format: int32
        description: 'Property Sequential (SeqLocal)'
      classId:
        type: integer
        format: int32
        description: 'Property Class ID (CodRamo)'
      modalityId:
        type: integer
        format: int32
        description: 'Property Modality ID (CodModalidade)'
      occupationId:
        type: string
        description: 'Property Occupation ID (CodOcupacao)'
      constructionId:
        type: integer
        format: int32
        description: 'Property Contruction Type ID (CodConstrucao)'
      planId:
        type: integer
        format: int32
        description: 'Property Plan ID (CodPlano)'
      commercialAdjustmentPerc:
        type: number
        format: double
        description: 'Property Commercial Adjustment Percentage (PercDescAgrvoComercial)'
      basicIndemnityLimit:
        type: number
        format: double
        description: 'Basic Indemnity Limit (VlrLMIBasica)'
      isInspected:
        type: boolean
        description: 'Informs if the property was inspected (FlagInspecao)'
      materialDamageRiskValue:
        type: number
        format: double
        description: 'Material damage risk value (VRDM)'
      hasMallRisk:
        type: boolean
        description: 'Has Mall Risk ? (Risco em Shopping)'
      address:
        $ref: '#/definitions/Address'
      coverage:
        $ref: '#/definitions/PropertyCoverage'
      renewalInfo:
        $ref: '#/definitions/RenewalInfo'
      additionalVariables:
        type: array
        description: 'Bureau Additional Variables (Variáveis externas dos birôs)'
        items:
          $ref: '#/definitions/AdditionalVariable'
      hasCalculationFlowChanged:
        type: boolean
        description: 'Informs wether the expected calculation flow has changed or not'
      claimCoverages:
        type: array
        description: 'Bureau Cobertura - Number of claims for Coverage(External bureau variable)'
        items:
          $ref: '#/definitions/ClaimCoverage' 
      endorsementInfo:
        $ref: '#/definitions/EndorsementInfo'    
      assetGrant:
        type: integer
        format: int32
        description: 'Type of property ? (1 - Prédio, 2 Conteudo, 3- Predio e Conteudo)'  
      questionnaires:
        type: array
        items:
          $ref: '#/definitions/Questionnaire'
      coverageNumberContracted:
        type: integer
        format: int32
        description: 'Numero coberturas contratadas por local'
      profitLossRiskValue:
        type: number
        format: double
        description: 'Valor em risco lucros cessantes (vrlc)'  
      segmentActivity:
        type: integer
        format: int32
        description: 'Type of segment ? (1 - Industria, 2 Comercio)'
  
  PropertyCoverage:
    title: PropertyCoverage
    description: 'Property Coverage'
    type: object
    properties:
      guarantees:
        type: array
        items:
          $ref: '#/definitions/PropertyGuarantee'
      protections:
        type: array
        items:
          $ref: '#/definitions/Protection'
      assistances:
        type: array
        items:
          $ref: '#/definitions/Assistance'
  
  ClaimCoverage:
    title: ClaimCoverage
    description: 'Claim Coverage'
    type: object
    properties:
      coverageCode:
        type: integer
        format: int32
        description: 'Coverage ID(CodCobertura)'
      claimNumber:
        type: integer
        format: int32
        description: 'Quantidade de Sinistro (QtdSinistro)'
  
  PropertyGuarantee:
    title: PropertyGuarantee
    description: 'Property Guarantee'
    type: object
    properties:
      id:
        type: integer
        format: int32
        description: 'Guarantee ID'
      code:
        type: integer
        format: int32
        description: 'Guarantee code (CodCobertura)'
      classId:
        type: integer
        format: int32
        description: 'Guarantee Class ID (CodRamo)'
      riskClassCode:
        type: integer
        format: int32
        description: 'Guarantee Class Code (CodEnquadramento - Classificação interna do risco da cobertura)'
      deductibleId:
        type: integer
        format: int32
        description: 'Guarantee Deductible ID (CodFranquia)'
      deductiblePercentage:
        type: number
        format: double
        description: 'Guarantee Deductible Percentage'
      optionalDeductibleId:
        type: integer
        format: int32
        description: 'Guarantee Optional Deductible ID (CodFranquiaFacultativa)'
      pricingRegionId:
        type: integer
        format: int32
        description: 'Guarantee Pricing Region ID (CodRegiao)'
      commercialAdjustmentPerc:
        type: number
        format: double
        description: 'Guarantee Commercial Adjustment Percentage (PercDescAgrvoComercial)'
      deductibleAmount:
        type: number
        format: double
        description: 'Mandatory Deductible Amount (VlrFranquia)'
      optionalDeductibleAmount:
        type: number
        format: double
        description: 'Optional Deductible Amount (VlrFranquiaFacultativa)'
      indemnityLimit:
        type: number
        format: double
        description: 'Guarantee Indemnity Limit Value (VlrLMI)'
      monthsIndemnityPeriod:
        type: integer
        format: int32
        description: 'Number months Indemnity Period (Período Indenitário)'
      isClaim:
        type: boolean
        description: 'claim on coverage?'
      endorsementInfo:
        $ref: '#/definitions/EndorsementInfo'
  
  Protection:
    title: Protection
    description: 'Protection'
    type: object
    properties:
      id:
        type: integer
        format: int32
        description: 'Protection ID'
  
  Assistance:
    title: Assistance
    description: 'Assistance'
    type: object
    properties:
      id:
        type: integer
        format: int32
        description: 'Assistance Code (CodAssitencia)'
      packageId:
        type: integer
        format: int32
        description: 'Assistance Package Code (CodPacote)'
      classId:
        type: integer
        format: int32
        description: 'Assistance Class Code (CodRamo)'
      adjustValue:
        type: number
        format: double
        description: 'Assistance Adjustment Value (ValorAgravo)'
  
  EndorsementInfo:
    title: EndorsementInfo
    description: 'Endorsement Info'
    type: object
    properties:
      movementType:
        type: array
        items:
          type: string
          enum:
            - NO_MOVIMENT
            - CEP_CHANGED
          example: NO_MOVIMENT,CEP_CHANGED
  
  Questionnaire:
    title: Questionnaire
    description: ''
    type: object
    properties:
      questionId:
        type: integer
        format: int32
      answerId:
        type: integer
        format: int32
  
  Address:
    title: Address
    description: 'Address'
    type: object
    properties:
      postalCode:
        description: 'Adress Postal Code (CEP)'
        type: string
      number:
        description: 'Property number at street'
        type: string
      geoLocation:  
        $ref: '#/definitions/GeoLocation'
      city:
        $ref: '#/definitions/City'

  RenewalInfo:
    title: RenewalInfo
    description: ''
    type: object
    properties:
      previousInsuranceDocumentKey:
        $ref: '#/definitions/InsuranceDocumentKey'
      previousPropertySeq:
        type: integer
        format: int32
        description: 'Previous Property Sequential (SeqLocal)'
      bonusClass:
        type: integer
        format: int32
        description: 'Bonus Class (ClasseBonus)'
      previousPlayerId:
        type: integer
        format: int32
        description: 'Previous Player Code (CodCongenere)'
      renewalTypeId:
        type: integer
        format: int32
        description: 'Renewal Type ID (CodTpRenovacao)'
      informedRenewalTypeId:
        type: integer
        format: int32
        description: 'Informed Renewal Type ID (CodTpRenovacaoInformado)'
      isActiveRenewal:
        type: boolean
        description: 'Is active Renewal ? (FlagRenovacaoAtiva)'
      isAilosEspecialRenewal:
        type: boolean
        description: 'Is Ailos Especial Renewal ?'
  
  AdditionalVariable:
    title: AdditionalVariable
    description: 'AdditionalVariable'
    type: object
    properties:
      key:
        type: string
        description: 'Variable Key'
      value:
        type: string
        description: 'Variable Value'
  
  GeoLocation:
    type: object
    title: GeoLocation
    description: 'Geo Location Entity'
    properties:     
      latitude:
        type: number
        format: double
        description: 'number the latitude of address'
      longitude:
        type: number
        format: double
        description: 'number the longitude of address'
  
  City:
    description: 'City Entity'
    type: object
    properties:
      code:
        description: 'City Code (CodCidade)'
        type: string
      state:
        $ref: '#/definitions/State'
        
  State:
    title: State
    description: 'State Entity'
    type: object
    properties:
      code:
        description: 'State Code (CodEstado)'
        type: string
        
  AdjustmentFactorList:
    title: AdjustmentFactorBusinessList
    type: array
    items:
      $ref: '#/definitions/AdjustmentFactor'

  AdjustmentFactor:
    title: AdjustmentFactor
    type: object
    description: Adjustment factor
    properties:
      key:
        type: string
        description: Adjustment Factor Key
      factor:
        type: number
        format: double
        description: Coefficient
    required:
    - factor
    - type